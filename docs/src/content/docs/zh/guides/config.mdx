---
title: SDK 配置
description: Customize API keys, tracing and logging behavior
---

import { Code } from '@astrojs/starlight/components';
import setDefaultOpenAIKeyExample from '../../../../../../examples/docs/config/setDefaultOpenAIKey.ts?raw';
import setDefaultOpenAIClientExample from '../../../../../../examples/docs/config/setDefaultOpenAIClient.ts?raw';
import setOpenAIAPIExample from '../../../../../../examples/docs/config/setOpenAIAPI.ts?raw';
import setOpenAIResponsesTransportExample from '../../../../../../examples/docs/config/setOpenAIResponsesTransport.ts?raw';
import setTracingExportApiKeyExample from '../../../../../../examples/docs/config/setTracingExportApiKey.ts?raw';
import setTracingDisabledExample from '../../../../../../examples/docs/config/setTracingDisabled.ts?raw';
import getLoggerExample from '../../../../../../examples/docs/config/getLogger.ts?raw';

本页介绍**SDK 全局默认设置**，这些设置通常会在应用启动时一次性完成，例如默认 OpenAI 客户端、传输方式、追踪导出密钥以及调试日志行为。这些设置默认在整个进程范围内生效，因此这里适合进行通用配置，而不是按智能体或按单次运行进行调优。

如果你需要改为配置特定的 `Agent`、`Runner` 或 `run()` 调用，请参见：

- [运行智能体](/openai-agents-js/zh/guides/running-agents) 了解 `Runner` 和单次运行选项。
- [模型](/openai-agents-js/zh/guides/models) 了解智能体级与 Runner 级的模型设置。
- [追踪](/openai-agents-js/zh/guides/tracing) 了解运行级追踪配置与导出器行为。

## OpenAI 客户端与传输

### API 密钥与客户端

默认情况下，SDK 会在需要创建 OpenAI 客户端时延迟解析 `OPENAI_API_KEY`。如果无法设置环境变量，请手动调用 `setDefaultOpenAIKey()`。

<Code
  lang="typescript"
  code={setDefaultOpenAIKeyExample}
  title="Set default OpenAI key"
/>

你也可以传入自己的 `OpenAI` 客户端实例。否则，SDK 会使用默认密钥自动创建一个。

<Code
  lang="typescript"
  code={setDefaultOpenAIClientExample}
  title="Set default OpenAI client"
/>

### API 选择

最后，你可以在 Responses API 与 Chat Completions API 之间切换。

<Code lang="typescript" code={setOpenAIAPIExample} title="Set OpenAI API" />

### Responses 传输

如果你使用的是 Responses API，还可以选择 OpenAI provider 传输方式。默认是 HTTP。

<Code
  lang="typescript"
  code={setOpenAIResponsesTransportExample}
  title="Set Responses transport"
/>

使用 `setOpenAIResponsesTransport('websocket')` 启用 WebSocket 传输，使用 `setOpenAIResponsesTransport('http')` 切回 HTTP。如果你通过代理或网关路由 websocket 流量，请设置 `OPENAI_WEBSOCKET_BASE_URL`（或在你的 `OpenAIProvider` 上配置 `websocketBaseURL`）。

## 可观测性与调试

### 追踪

在受支持的服务器运行时中，追踪默认启用。在浏览器中以及 `NODE_ENV=test` 时，默认禁用。

默认情况下，追踪导出会使用上文中的同一个 OpenAI 密钥。

也可以通过 `setTracingExportApiKey()` 设置单独的密钥：

<Code
  lang="typescript"
  code={setTracingExportApiKeyExample}
  title="Set tracing export API key"
/>

也可以完全禁用追踪：

<Code
  lang="typescript"
  code={setTracingDisabledExample}
  title="Disable tracing"
/>

如果你想进一步了解追踪功能，请查看[追踪指南](/openai-agents-js/zh/guides/tracing)。

### 调试日志

SDK 使用 [`debug`](https://www.npmjs.com/package/debug) 包进行调试日志记录。将 `DEBUG` 环境变量设为 `openai-agents*` 可查看详细日志。

```bash
export DEBUG=openai-agents*
```

如需记录会话持久化活动，请设置 `OPENAI_AGENTS__DEBUG_SAVE_SESSION=1`。

你可以从 `@openai/agents` 使用 `getLogger(namespace)` 为自己的模块获取带命名空间的日志器。

<Code lang="typescript" code={getLoggerExample} title="Get logger" />

#### 日志中的敏感数据

某些日志可能包含用户数据。可通过设置以下环境变量禁用它们。

要禁用 LLM 输入与输出日志：

```bash
export OPENAI_AGENTS_DONT_LOG_MODEL_DATA=1
```

要禁用工具输入与输出日志：

```bash
export OPENAI_AGENTS_DONT_LOG_TOOL_DATA=1
```
