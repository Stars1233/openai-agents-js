---
title: 使用 AI SDK 指定任意模型
description: Connect your Agents SDK agents to any model through the Vercel's AI SDK
---

import { Aside, Steps, Code } from '@astrojs/starlight/components';
import aiSdkImportsExample from '../../../../../../examples/docs/extensions/ai-sdk-imports.ts?raw';
import aiSdkModelExample from '../../../../../../examples/docs/extensions/ai-sdk-model.ts?raw';
import aiSdkProviderDataExample from '../../../../../../examples/docs/extensions/ai-sdk-providerData.ts?raw';
import aiSdkProviderMetadataExample from '../../../../../../examples/docs/extensions/ai-sdk-providerMetadata.ts?raw';
import aiSdkSetupExample from '../../../../../../examples/docs/extensions/ai-sdk-setup.ts?raw';
import aiSdkUiMessageStreamResponseExample from '../../../../../../examples/docs/extensions/ai-sdk-ui-message-stream-response.ts?raw';
import aiSdkTextStreamResponseExample from '../../../../../../examples/docs/extensions/ai-sdk-text-stream-response.ts?raw';

<Aside type="caution">
  此适配器仍处于 beta
  阶段。您可能会在某些模型提供商上遇到问题，尤其是较小的提供商。请通过 [GitHub
  issues](https://github.com/openai/openai-agents-js/issues)
  报告任何问题，我们会尽快修复。
</Aside>

Agents SDK 开箱即用可通过 Responses API 或 Chat Completions API 与 OpenAI 模型协同工作。不过，如果您希望使用其他模型，[Vercel AI SDK](https://sdk.vercel.ai/) 提供了一系列受支持的模型，可通过此适配器接入 Agents SDK。

## 设置

<Steps>

1. 通过安装扩展包来安装 AI SDK 适配器：

   ```bash
   npm install @openai/agents-extensions
   ```

2. 从 [Vercel 的 AI SDK](https://ai-sdk.dev/docs/foundations/providers-and-models) 中选择所需的模型包并安装：

   ```bash
   npm install @ai-sdk/openai
   ```

3. 导入适配器和模型，以连接到您的智能体：

   <Code lang="typescript" code={aiSdkImportsExample} title="导入适配器" />

4. 初始化智能体要使用的模型实例：

   <Code lang="typescript" code={aiSdkModelExample} title="创建模型" />

</Steps>

<Aside type="caution">
  我们支持暴露 `specificationVersion` `v2` 或 `v3` 的 AI SDK 提供商。
  如果您有特定原因需要继续使用较旧的 v1 提供商风格， 可以从
  [examples/ai-sdk-v1](https://github.com/openai/openai-agents-js/tree/main/examples/ai-sdk-v1)
  复制该模块并将其包含到您的项目中。
</Aside>

## 示例

<Code lang="typescript" code={aiSdkSetupExample} title="AI SDK 设置" />

## 传递提供商元数据

如果您需要随消息发送提供商特定选项，请通过 `providerMetadata` 传递。其值会直接转发到底层 AI SDK 模型。例如，Agents SDK 中如下的 `providerData`

<Code
  lang="typescript"
  code={aiSdkProviderDataExample}
  title="Agents SDK providerData"
/>

在使用 AI SDK 集成时会变为

<Code
  lang="typescript"
  code={aiSdkProviderMetadataExample}
  title="AI SDK providerMetadata"
/>

## 集成选择

`@openai/agents-extensions` 中有两个相关集成：

- `@openai/agents-extensions/ai-sdk` 将 AI SDK 模型适配为可由 `Agent` 运行。
- `@openai/agents-extensions/ai-sdk-ui` 将流式 Agents SDK 运行适配为 AI SDK UI 路由可返回标准流式 `Response`。

## AI SDK UI 流辅助函数

`@openai/agents-extensions/ai-sdk-ui` 提供了响应辅助函数，用于将 Agents SDK 流接入 AI SDK UI 路由：

- `createAiSdkTextStreamResponse(source, options?)` 用于纯文本流式响应。
- `createAiSdkUiMessageStreamResponse(source, options?)` 用于 `UIMessageChunk` 流式响应。

两个辅助函数都接受 `StreamedRunResult`、类流 source 或兼容的包装对象，并返回带有流式友好头的 `Response`。

当您的 UI 需要结构化分块（如工具调用或推理片段）时，使用 `createAiSdkUiMessageStreamResponse(...)`。当您只需要纯文本时，使用 `createAiSdkTextStreamResponse(...)`。

用于 UI 消息流式传输的 Next.js 路由示例：

<Code
  lang="typescript"
  code={aiSdkUiMessageStreamResponseExample}
  title="UI 消息流响应"
/>

用于仅文本流式传输的 Next.js 路由示例：

<Code
  lang="typescript"
  code={aiSdkTextStreamResponseExample}
  title="文本流响应"
/>

关于端到端用法，请参阅此仓库中的 `examples/ai-sdk-ui` 应用。
