---
title: SDK の設定
description: Customize API keys, tracing and logging behavior
---

import { Code } from '@astrojs/starlight/components';
import setDefaultOpenAIKeyExample from '../../../../../../examples/docs/config/setDefaultOpenAIKey.ts?raw';
import setDefaultOpenAIClientExample from '../../../../../../examples/docs/config/setDefaultOpenAIClient.ts?raw';
import setOpenAIAPIExample from '../../../../../../examples/docs/config/setOpenAIAPI.ts?raw';
import setOpenAIResponsesTransportExample from '../../../../../../examples/docs/config/setOpenAIResponsesTransport.ts?raw';
import setTracingExportApiKeyExample from '../../../../../../examples/docs/config/setTracingExportApiKey.ts?raw';
import setTracingDisabledExample from '../../../../../../examples/docs/config/setTracingDisabled.ts?raw';
import getLoggerExample from '../../../../../../examples/docs/config/getLogger.ts?raw';

このページでは、通常はアプリ起動時に一度だけ設定する **SDK 全体のデフォルト** を扱います。たとえば、デフォルトの OpenAI クライアント、トランスポート、トレーシングのエクスポートキー、デバッグログの動作などです。これらの設定はデフォルトでプロセス全体に適用されるため、エージェント単位や実行単位の調整ではなく、共通設定を行うのに適しています。

代わりに特定の `Agent`、`Runner`、または `run()` 呼び出しを設定したい場合は、以下を参照してください。

- `Runner` と実行ごとのオプションは [エージェントの実行](/openai-agents-js/ja/guides/running-agents) を参照
- エージェントレベルおよび Runner レベルのモデル設定は [モデル](/openai-agents-js/ja/guides/models) を参照
- 実行固有のトレーシング設定とエクスポーターの動作は [トレーシング](/openai-agents-js/ja/guides/tracing) を参照

## OpenAI クライアントとトランスポート

### API キーとクライアント

デフォルトでは SDK は OpenAI クライアントの作成が必要になった時点で `OPENAI_API_KEY` を遅延解決します。環境変数を設定できない場合は、`setDefaultOpenAIKey()` を手動で呼び出してください。

<Code
  lang="typescript"
  code={setDefaultOpenAIKeyExample}
  title="Set default OpenAI key"
/>

独自の `OpenAI` クライアントインスタンスを渡すこともできます。指定しない場合、SDK はデフォルトキーを使って自動的に作成します。

<Code
  lang="typescript"
  code={setDefaultOpenAIClientExample}
  title="Set default OpenAI client"
/>

### API の選択

最後に、Responses API と Chat Completions API を切り替えることもできます。

<Code lang="typescript" code={setOpenAIAPIExample} title="Set OpenAI API" />

### Responses トランスポート

Responses API を使っている場合は、OpenAI プロバイダーのトランスポートも選択できます。デフォルトは HTTP です。

<Code
  lang="typescript"
  code={setOpenAIResponsesTransportExample}
  title="Set Responses transport"
/>

`setOpenAIResponsesTransport('websocket')` を使用すると WebSocket トランスポートを有効化でき、`setOpenAIResponsesTransport('http')` で HTTP に戻せます。プロキシやゲートウェイ経由で websocket トラフィックをルーティングする場合は、`OPENAI_WEBSOCKET_BASE_URL` を設定してください（または `OpenAIProvider` の `websocketBaseURL` を設定してください）。

このプロセス全体のデフォルトは、後からデフォルトの OpenAI プロバイダー経由で解決されるモデルにのみ影響します。具体的な `Model` インスタンスやカスタムの `modelProvider` を渡す場合は、代わりにそちらでトランスポートを設定してください。[モデルガイド](/openai-agents-js/ja/guides/models#responses-websocket-transport) を参照してください。

## 可観測性とデバッグ

### トレーシング

トレーシングは、サポートされるサーバーランタイムではデフォルトで有効です。ブラウザー環境と `NODE_ENV=test` の場合はデフォルトで無効です。

デフォルトでは、トレースエクスポートは上記セクションと同じ OpenAI キーを使用します。

`setTracingExportApiKey()` で別のキーを設定できます。

<Code
  lang="typescript"
  code={setTracingExportApiKeyExample}
  title="Set tracing export API key"
/>

トレーシングを完全に無効化することもできます。

<Code
  lang="typescript"
  code={setTracingDisabledExample}
  title="Disable tracing"
/>

トレーシング機能の詳細は、[トレーシングガイド](/openai-agents-js/ja/guides/tracing) を確認してください。

### デバッグログ

SDK はデバッグログに [`debug`](https://www.npmjs.com/package/debug) パッケージを使用します。`DEBUG` 環境変数を `openai-agents*` に設定すると、詳細ログを表示できます。

```bash
export DEBUG=openai-agents*
```

セッション永続化のアクティビティをログ出力するには、`OPENAI_AGENTS__DEBUG_SAVE_SESSION=1` を設定してください。

`@openai/agents` の `getLogger(namespace)` を使うと、独自モジュール向けに名前空間付きロガーを取得できます。

<Code lang="typescript" code={getLoggerExample} title="Get logger" />

#### ログ内の機微データ

一部のログにはユーザーデータが含まれる可能性があります。以下の環境変数を設定して無効化してください。

LLM の入力と出力のログを無効化するには:

```bash
export OPENAI_AGENTS_DONT_LOG_MODEL_DATA=1
```

ツールの入力と出力のログを無効化するには:

```bash
export OPENAI_AGENTS_DONT_LOG_TOOL_DATA=1
```
